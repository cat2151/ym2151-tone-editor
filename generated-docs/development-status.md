Last updated: 2025-11-12

# Development Status

## 現在のIssues
- [Issue #5](../issue-notes/5.md) は、アプリケーション起動時にカレントディレクトリから最新のJSONファイルを音色データとして読み込み、表示に反映する機能の実装を目指しています。
- [Issue #2](../issue-notes/2.md) は、ユーザーが数値を増減させた際に、子プロセスとして `cat-play-mml` を呼び出し、音色を再生する機能の追加が課題です。
- これらの課題は、YM2151音色エディタの保存データのロード機能とリアルタイムな音色確認機能の実現に向けた重要なステップとなります。

## 次の一手候補
1. [Issue #5](../issue-notes/5.md) 起動時JSON音色データ自動読み込み機能の実装
   - 最初の小さな一歩: `src/main.rs` に、カレントディレクトリ内の `*.json` ファイルを検索し、最新のもののファイルパスを取得するロジックを追加する。
   - Agent実行プロンプト:
     ```
     対象ファイル: `src/main.rs`

     実行内容: `src/main.rs` 内のアプリケーション起動処理部分を分析し、カレントディレクトリから最新の `.json` ファイルを自動的に検索し、その絶対パスを文字列として取得するロジックを提案してください。ファイルが見つからない場合はエラーメッセージを表示するが、アプリケーションは終了しないようにしてください。このパスは後続のデータ読み込み処理で利用するための準備とします。

     確認事項: ファイル検索ロジックが既存のアプリケーション起動フロー（例: `main` 関数や初期化関数）と競合しないこと。エラーハンドリング（ファイルが見つからない場合や、読み取り権限がない場合など）の考慮。Rustの標準ライブラリ（`std::fs`, `std::path`, `std::time`など）を使用すること。

     期待する出力: `src/main.rs` に対する変更提案のRustコードブロックと、その変更の意図、具体的な挿入箇所、およびエラーハンドリングに関する説明をmarkdown形式で出力してください。
     ```

2. [Issue #2](../issue-notes/2.md) 数値増減時の `cat-play-mml` 子プロセス呼び出しの基盤構築
   - 最初の小さな一歩: `src/main.rs` 内で、ユーザーが数値を増減させるイベント（例: キーボード入力処理）を捕捉し、そのイベント発生時に子プロセスを呼び出すためのプレースホルダーコード（ダミーのコマンド実行）を挿入する箇所を特定し、実装する。
   - Agent実行プロンプト:
     ```
     対象ファイル: `src/main.rs`

     実行内容: `src/main.rs` のコードを分析し、ユーザー入力によるYM2151パラメータの数値増減が発生するロジックを特定してください。その数値増減イベントが発生した際に、ダミーとして子プロセスを起動するRustコード（例: `std::process::Command::new("echo").arg("cat-play-mml called").spawn().expect("failed to execute process");`）を挿入する箇所を提案し、そのプレースホルダーコードを追加してください。

     確認事項: 現在のイベントループや入力処理の構造を壊さないこと。子プロセスの生成はアプリケーションのUIスレッドをブロックしない（ノンブロッキングである）ことを考慮し、適切なAPI（例: `spawn`）を使用すること。`cat-play-mml` の具体的なコマンド引数はまだ考慮せず、呼び出しの基盤のみを構築すること。

     期待する出力: `src/main.rs` に対する変更提案のRustコードブロックと、そのコードの挿入箇所、および変更の意図と子プロセス呼び出しに関する考慮事項を説明するmarkdown形式の出力。
     ```

3. `src/main.rs` のUIとYM2151ロジックの責務分離リファクタリング計画
   - 最初の小さな一歩: `src/main.rs` 内で、YM2151の音色データ構造、MML生成ロジック、UI表示・入力処理ロジックの各セクションを特定し、それぞれの責務を担うべき新しいモジュールとその主要な関数/構造体の役割を定義する。
   - Agent実行プロンプト:
     ```
     対象ファイル: `src/main.rs`

     実行内容: `src/main.rs` のコードベースを詳細に分析し、以下の3つの主要な責務を明確に分離するための構造設計案を提案してください：
     1) YM2151音色データの管理（データ構造、パラメータの更新など）
     2) MML文字列の生成ロジック
     3) ターミナルUIの表示とユーザー入力処理
     これらの責務を担うべき新しいモジュール（例: `ym2151_data.rs`, `mml_generator.rs`, `ui_renderer.rs`など）に分割する際の、各モジュールの責務、主要な構造体、およびそれらのモジュール間の連携方法についてmarkdown形式で記述してください。

     確認事項: リファクタリングによってアプリケーションの既存機能が損なわれないこと。将来的な機能拡張やテストのしやすさを考慮したモジュール設計であること。Rustのモジュールシステム（`mod`, `pub`など）を適切に利用すること。

     期待する出力: `src/main.rs` のリファクタリングに関する構造設計案をmarkdown形式で出力してください。新しいモジュール名、それぞれのモジュールが持つべき具体的な責務、主要な構造体/関数、およびそれらの相互作用について詳細に記述してください。

---
Generated at: 2025-11-12 07:08:57 JST
