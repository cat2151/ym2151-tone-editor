Last updated: 2025-11-28

# Development Status

## 現在のIssues
- [Issue #116](../issue-notes/116.md) は、GM音色名リスト `tone_names.json` の作成と整備を進め、音色管理の効率化を目指します。
- [Issue #115](../issue-notes/115.md) は、slow attack音色が連続再生時に継続する問題を、D2R=15によるkey offと短い待ち時間で解決する対策を提案しています。
- [Issue #114](../issue-notes/114.md) および関連Issue ([Issue #111](../issue-notes/111.md), [Issue #110](../issue-notes/110.md)など) は、特定のUI要素の隣にキーガイドを表示し、キーバインド操作のUX改善を目指します。

## 次の一手候補
1. [Issue #115](../issue-notes/115.md): AR 1のslow attack音色で発生するattack envelope継続問題を修正
   - 最初の小さな一歩: `src/audio.rs` 内でMIDI Note Offイベントを送信している箇所を特定し、key off前にD2R=15設定と短い待ち時間を挿入するロジックを分析する。
   - Agent実行プロンプ:
     ```
     対象ファイル: `src/audio.rs`

     実行内容: `src/audio.rs` 内でMIDI Note Offイベントを送信している箇所を特定し、その直前にD2R (Decay 2 Rate) を15に設定するYM2151レジスタ操作を追加し、さらにkey off後、次のNote Onイベントまでの間に約5ミリ秒の待ち時間（delay）を挿入するためのRustコードの変更点を提案してください。D2R設定がYM2151のどのレジスタに対応し、どのように設定されるか（例：オペレーターごとに設定が必要か、または全体設定か）も考慮して記述してください。

     確認事項:
     - MIDIイベントの送信ロジック（特にNote On/Off）がどのように実装されているか確認してください。
     - YM2151のD2Rレジスタ設定に対応する具体的な操作が何かを調査してください。
     - 既存の音色再生タイミングやアプリケーション全体のパフォーマンスへの影響を考慮してください。

     期待する出力: `src/audio.rs` に適用可能なRustコードの変更案。D2R設定と待ち時間の追加が明確に示されていること。
     ```

2. [Issue #116](../issue-notes/116.md): `tone_names.json` の内容をGeneral MIDI標準に沿って精査し、JSON形式を修正する
   - 最初の小さな一歩: `tones/general_midi/tone_names.json` の既存内容をGeneral MIDIの000～127番の標準音色名と照合し、現在の不正なJSON形式を、`{"音色名": "MMLスニペット"}` のような正しいオブジェクト形式に修正する。
   - Agent実行プロンプト:
     ```
     対象ファイル: `tones/general_midi/tone_names.json`

     実行内容: `tones/general_midi/tone_names.json` の内容を修正してください。現在のファイルはJSONとして不正な形式です。これを、General MIDI (GM) 000番から127番までの標準的な音色名をキーとし、対応するMML記述（現在のファイルに記載されているもの、または適切なプレースホルダー）を値とするオブジェクト形式のJSONファイルにしてください。コメントアウトされているMML部分は、可能な限り適切なMMLスニペットに修正してください。

     確認事項:
     - General MIDIのProgram Change番号と対応する標準音色名の正確性を確認してください。
     - 生成されるJSONファイルが厳密なJSON形式の構文ルールに準拠しているか確認してください。
     - MMLスニペットが既存のYM2151エディタのMMLフォーマットと互換性があるか、必要に応じて修正提案を行ってください。

     期待する出力: 修正され、GM標準に準拠し、かつJSONとして正しい形式の`tones/general_midi/tone_names.json`の完全な内容。
     ```

3. [Issue #112](../issue-notes/112.md): ALG7選択時のアプリクラッシュ原因を特定し、修正の方向性を提示する
   - 最初の小さな一歩: ALG7選択時にアプリがクラッシュする現象を再現し、クラッシュ発生時のスタックトレースやエラーメッセージを収集・分析する。特にUIの描画や座標計算に関連する部分に注目する。
   - Agent実行プロンプト:
     ```
     対象ファイル: `src/ui.rs`, `src/app.rs`, `src/midi_conversion.rs` およびUI描画・イベント処理に関連するファイル全般

     実行内容: [Issue #112](../issue-notes/112.md) で報告されているALG7選択時のアプリクラッシュの原因を特定するため、`src/ui.rs`, `src/app.rs`, `src/midi_conversion.rs` および仮想MIDI鍵盤の描画やイベント処理に関連するファイルを分析してください。特に、ALGの表示高さが他のUI要素（特に仮想MIDI鍵盤）のY座標計算にどのように影響しているかを調査し、座標計算のオーバーフローや範囲外アクセスが発生しうる箇所をRustコードのコンテキストで指摘してください。

     確認事項:
     - ALG7の描画ロジックが他のALG（例：ALG0-6）とどのように異なるかを確認してください。
     - 仮想MIDI鍵盤のY座標が、利用可能な画面領域に対してどのように計算されているかを確認してください。
     - TUI (Text User Interface) ライブラリが提供する描画領域管理の制約や、その利用方法に問題がないか確認してください。
     - ALG表示高さと仮想MIDI鍵盤の間に予期せぬオーバーラップや描画領域の衝突がないか確認してください。

     期待する出力: クラッシュの原因と推定される箇所（ファイル、行番号、関数名）を具体的に特定し、問題のあるコードスニペットと、その修正に向けた初期の考察をMarkdown形式で記述してください。

---
Generated at: 2025-11-28 07:08:29 JST
