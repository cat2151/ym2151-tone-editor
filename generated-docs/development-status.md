Last updated: 2025-12-02

# Development Status

## 現在のIssues
- 現在、[Issue #115](../issue-notes/115.md)ではAR 1のslow attack音色を仮想MIDI鍵盤で連続プレビューした際に、アタックエンベロープが次のノートに継続してしまう問題が発生しています。
- [Issue #112](../issue-notes/112.md)では、ALG7を選択するとアプリケーションがクラッシュするという重大なバグがあり、UIの描画範囲や仮想MIDI鍵盤の座標計算に問題がある可能性が指摘されています。
- また、[Issue #114](../issue-notes/114.md)では、A,D,S,Rなどのカーソルジャンプ可能な項目の左隣に、対応するキー操作のガイドを表示することでユーザーの操作性を向上させるUI改善が提案されています。

## 次の一手候補
1.  [Issue #115](../issue-notes/115.md): AR 1のslow attack音色が連続preview時にnoteをまたいでattack envelopeが継続される問題を修正
    - 最初の小さな一歩: YM2151の仕様に基づき、D2R=15でkey off後、数ms待機することでenvelope振幅を0にリセットする処理をMIDIノートオフシーケンスに追加するためのプロトタイプ実装を検討する。
    - Agent実行プロンプ:
      ```
      対象ファイル: `src/midi_conversion.rs`, `src/app.rs`

      実行内容: `src/midi_conversion.rs`内でのMIDIノートオフ処理について、[Issue #115](../issue-notes/115.md)で提案されているD2R=15の送信と短いウェイト（0.005秒程度）を追加する変更を分析し、実装に必要なコード変更を提案してください。`src/app.rs`でMIDIイベントがどのように処理され、`src/midi_conversion.rs`に渡されているかを確認し、変更が正しく統合されるか検証してください。

      確認事項: 既存のMIDIノートオフ処理に副作用がないこと。特に、短いウェイトが他のMIDIイベント処理のタイミングに影響を与えないことを確認してください。また、YM2151の仕様に合致しているか再確認してください。

      期待する出力: D2R=15送信とウェイト追加を含む`src/midi_conversion.rs`の修正案、および必要に応じて`src/app.rs`での呼び出し方法の調整に関するmarkdown形式のコードスニペットと説明。
      ```

2.  [Issue #112](../issue-notes/112.md): ALG7選択時のアプリクラッシュの原因特定と修正
    - 最初の小さな一歩: ALG7選択時にUIがどのように描画され、仮想MIDI鍵盤のY座標がどのように計算されているかを特定し、クラッシュを引き起こしている可能性のあるUI要素のサイズオーバーフローや描画範囲外アクセス箇所を分析する。
    - Agent実行プロンプ:
      ```
      対象ファイル: `src/ui.rs`, `src/app.rs`

      実行内容: [Issue #112](../issue-notes/112.md)の報告に基づき、`src/ui.rs`におけるALG7描画ロジックと仮想MIDI鍵盤のY座標計算ロジックを詳細に分析してください。特に、ALG7の表示heightが高いこと、または仮想MIDI鍵盤のY座標が画面範囲外になる可能性に焦点を当て、クラッシュを引き起こす可能性のあるコード箇所を特定し、その原因と修正案をmarkdown形式で出力してください。`src/app.rs`でUI状態がどのように管理されているかも合わせて確認してください。

      確認事項: ALG7だけでなく、他のアルゴリズム選択時にも同様の問題が発生しないか、または将来的に発生する可能性があるかを確認してください。UI要素のサイズ計算がハードコードされていないか、動的に調整可能かどうかも確認してください。

      期待する出力: クラッシュの原因となっているコード箇所の特定、およびそれを修正するためのコードスニペットと、UI描画ロジックの改善に関する具体的な提案をmarkdown形式で。
      ```

3.  [Issue #114](../issue-notes/114.md): カーソルジャンプ可能な項目へのキーガイド表示機能の実装
    - 最初の小さな一歩: 現在カーソルジャンプが可能なUI要素（A,D,S,Rなど）を`src/ui.rs`と`src/config.rs`から特定し、それぞれの項目に対応するキーバインド情報を取得する方法を確立する。
    - Agent実行プロンプ:
      ```
      対象ファイル: `src/ui.rs`, `src/config.rs`, `src/app.rs`

      実行内容: [Issue #114](../issue-notes/114.md)の実装に向け、`src/ui.rs`内でカーソルジャンプ可能なUI要素の描画箇所を特定し、これらの要素が`src/config.rs`で定義されたキーバインドとどのように関連付けられているかを分析してください。選択中のUI要素の左隣に、その要素にジャンプするために押すべきキー（例: 'A' for Attack）を動的に表示するUI設計と、その実装に必要なコード変更案をmarkdown形式で提案してください。`src/app.rs`でのイベントハンドリングとUI状態の管理も考慮に入れてください。

      確認事項: キーガイド表示が既存のUIレイアウトに干渉しないこと、およびキーバインドが変更された際に動的にガイドも更新される柔軟性があることを確認してください。

      期待する出力: カーソルジャンプ可能なUI要素とキーバインドの対応関係、キーガイド表示のUI設計案、および`src/ui.rs`と`src/config.rs`（必要であれば`src/app.rs`も）の修正に関するmarkdown形式のコードスニペットと説明。

---
Generated at: 2025-12-02 07:08:06 JST
