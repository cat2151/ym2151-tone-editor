Last updated: 2025-12-01

# Development Status

## 現在のIssues
- [Issue #112](../issue-notes/112.md)で報告されたALG7選択時のアプリクラッシュの原因（ALG表示高さと仮想MIDI鍵盤Y座標の考慮漏れ）を特定し修正が必要です。
- [Issue #115](../issue-notes/115.md)のAR 1 slow attack音色プレビュー時のエンベロープ継続問題を、D2R=15によるkey offと待機処理の追加で解決する必要があります。
- [Issue #116](../issue-notes/116.md)で作成した`tone_names.json`を活用し、GM音色名の管理を効率化し、[Issue #114](../issue-notes/114.md)のキーガイド表示を含むUI/UX向上を進める必要があります。

## 次の一手候補
1. ALG7選択時のアプリクラッシュバグを修正する [[Issue #112](../issue-notes/112.md)]
   - 最初の小さな一歩: ALG7選択時にアプリがクラッシュする原因を、ALG表示の高さと仮想MIDI鍵盤のY座標計算の関連性から分析し、問題箇所を特定する。
   - Agent実行プロンプ:
     ```
     対象ファイル: `src/ui.rs`, `src/app.rs`

     実行内容: ALG7を選択した際にアプリケーションがクラッシュする問題（[Issue #112](../issue-notes/112.md)）について、以下の観点から原因を分析し、修正が必要なコードブロックをmarkdown形式で特定してください。
     1) ALG7のUI要素の描画ロジック（特に高さ計算）
     2) 仮想MIDI鍵盤のY座標計算ロジック
     3) 上記2つの要素がどのように相互作用し、範囲外アクセスやパニックを引き起こす可能性があるか

     確認事項: ALG7以外のアルゴリズム選択時や、仮想MIDI鍵盤の表示範囲変更時にも同様の問題が発生しないか、関連するUI要素の描画ロジックを広く確認してください。

     期待する出力: 問題の原因と、その修正のために変更すべき具体的なファイルパス、関数名、および該当コードブロックをmarkdownコードブロックで示してください。
     ```

2. AR 1 slow attack音色エンベロープ継続問題を解決する [[Issue #115](../issue-notes/115.md)]
   - 最初の小さな一歩: [Issue #115](../issue-notes/115.md)に記載されている対策案（D2R=15でのkey offと待機処理の追加）を実装するため、音色データJSONの生成ロジックを特定する。
   - Agent実行プロンプト:
     ```
     対象ファイル: `src/midi_conversion.rs`, `src/audio.rs`

     実行内容: [Issue #115](../issue-notes/115.md)で提案されている「JSON先頭のkey offの前に、D2R=15を追加し、key offの後の時刻を0.005秒等にする」という対策案の実装に必要なコード変更箇所を特定し、その変更が他の音色や機能に与える影響を分析してください。具体的には、MIDIイベントをYM2151コマンドに変換し、JSON形式で出力する部分に注目してください。

     確認事項: D2R=15の追加と待機処理が、他のエンベロープ設定や高速なノートオン/オフの処理に悪影響を与えないか、YM2151の仕様と既存のオーディオ出力ロジックとの整合性を確認してください。

     期待する出力: 対策案を実装するために変更すべき具体的なファイルパス、関数名、および擬似コードまたは具体的な変更例をmarkdown形式で示してください。
     ```

3. `tone_names.json`の活用とキーガイド表示の連携を進める [[Issue #116](../issue-notes/116.md), [Issue #114](../issue-notes/114.md)]
   - 最初の小さな一歩: `tones/general_midi/tone_names.json`の内容をアプリケーションに読み込み、音色名として利用できるようにする。その上で、[Issue #114](../issue-notes/114.md)で要求されている「カーソルジャンプできる項目の左隣に押すキーのガイドを表示」するUIを実装するための準備として、現在どの項目がカーソルジャンプ可能か、そしてそのUI描画ロジックを特定する。
   - Agent実行プロンプト:
     ```
     対象ファイル: `src/config.rs`, `src/ui.rs`, `tones/general_midi/tone_names.json`

     実行内容:
     1) `tones/general_midi/tone_names.json` の内容をアプリケーション起動時に読み込み、メモリ上に保持するための最適な方法を`src/config.rs`または関連ファイルで検討してください。
     2) `src/ui.rs`内で、現在ユーザーが特定のキー（A, D, S, Rなど）でカーソルジャンプできるUI要素の描画ロジックと、そのキーバインドがどのように管理されているかを分析してください。
     3) 上記分析に基づき、カーソルジャンプ可能な項目に対して、その左隣にキーガイド（例：「A: 」）を表示するためのコード変更が必要な箇所を特定してください。

     確認事項: `tone_names.json`の読み込みがアプリケーションの起動時間やメモリ使用量に影響を与えないか、またUI描画ロジックの変更が既存のキーバインドや他のUI要素のレイアウトを破壊しないかを確認してください。

     期待する出力: `tone_names.json`を読み込むための構造体や関数、そしてキーガイド表示のために変更すべき`src/ui.rs`内の具体的な関数名と、その周辺のコードブロックをmarkdown形式で示してください。

---
Generated at: 2025-12-01 07:08:17 JST
