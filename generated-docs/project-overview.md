Last updated: 2025-12-01

# Project Overview

## プロジェクト概要
- YM2151（OPM）FM音源の音色をターミナル上で編集するためのアプリケーションです。
- Rustで開発されており、Windows環境でリアルタイムな音声フィードバックを提供します。
- シンプルな操作性と迅速な音色プレビューを通じて、直感的な音作りを支援します。

## 技術スタック
- フロントエンド: **ratatui 0.28** (Rust製ターミナルUIフレームワーク。リッチなテキストベースのユーザーインターフェースを構築するために使用されます。)、**crossterm 0.28** (クロスプラットフォーム対応のターミナル操作ライブラリ。キー入力、マウスイベント、画面描画などの低レベルなターミナル操作を提供します。)
- 音楽・オーディオ: **ym2151-log-play-server** (リアルタイム音声フィードバックを実現するためのRustライブラリ。音色エディタから送られるYM2151レジスタデータを処理し、音声として出力します。)
- 開発ツール: **Rust 1.70 以降** (システムプログラミング言語。パフォーマンス、安全性、並行性を重視しており、本プロジェクトの基盤言語です。)、**Cargo** (Rustの公式ビルドシステム兼パッケージマネージャ。依存関係の管理、プロジェクトのビルド、テスト、実行を効率的に行います。)
- テスト: Rustの標準テスト機能 (`src/tests/` ディレクトリ配下に各モジュールの単体テストが記述されています。)
- ビルドツール: **Cargo** (Rustプロジェクトのビルドプロセスを管理します。`cargo build --release`コマンドで最適化された実行ファイルを生成します。)
- 言語機能: **Rust 1.70 以降** (本プロジェクトの開発および実行に必要なRustのバージョンです。)
- 自動化・CI/CD: **Cargo** (ビルド、テスト、実行の各フェーズをコマンドラインで容易に実行できるため、自動化スクリプトやCI/CDパイプラインに組み込みやすい構造です。)
- 開発標準: **Rustfmt** (Rustコードの自動フォーマッタ。コードスタイルの一貫性を保ちます。)、**Clippy** (Rustのリンター。一般的な間違いや非効率なコードを検出します。)

## ファイル階層ツリー
```
📄 .gitignore
📄 Cargo.lock
📄 Cargo.toml
📄 LICENSE
📖 README.ja.md
📖 README.md
📄 _config.yml
📁 docs/
  📖 KEYBINDS.ja.md
📁 generated-docs/
📁 issue-notes/
  📖 100.md
  📖 101.md
  📖 102.md
  📖 103.md
  📖 104.md
  📖 105.md
  📖 106.md
  📖 107.md
  📖 108.md
  📖 109.md
  📖 110.md
  📖 111.md
  📖 112.md
  📖 113.md
  📖 114.md
  📖 115.md
  📖 116.md
  📖 95.md
  📖 96.md
  📖 97.md
  📖 99.md
📁 src/
  📄 app.rs
  📄 app_init.rs
  📄 audio.rs
  📄 config.rs
  📄 file_ops.rs
  📄 main.rs
  📄 midi_conversion.rs
  📄 models.rs
  📄 register.rs
  📁 tests/
    📄 app_tests.rs
    📄 file_ops_tests.rs
    📄 midi_conversion_tests.rs
    📄 mod.rs
    📄 register_tests.rs
    📄 ui_tests.rs
    📄 verbose_logging_tests.rs
  📄 ui.rs
📁 tones/
  📁 general_midi/
    📊 000_AcousticGrand.json
    📊 tone_names.json
📄 ym2151-tone-editor.toml.example
```

## ファイル詳細説明
- **`.gitignore`**: Gitがバージョン管理の対象から除外すべきファイルやディレクトリを指定する設定ファイルです。ビルド生成物や一時ファイルなどが含まれます。
- **`Cargo.lock`**: プロジェクトが依存するすべてのクレート（ライブラリ）の正確なバージョンとチェックサムを記録します。これにより、異なる環境でも一貫したビルド結果が保証されます。
- **`Cargo.toml`**: Rustプロジェクトのマニフェストファイル。プロジェクト名、バージョン、著者情報、依存関係のクレートなどを定義します。
- **`LICENSE`**: プロジェクトのソフトウェアライセンス情報が記述されています。
- **`README.ja.md`**: プロジェクトの目的、機能、使用方法などが日本語でまとめられたドキュメントです。
- **`README.md`**: プロジェクトの目的、機能、使用方法などが英語でまとめられたドキュメントです。
- **`_config.yml`**: GitHub Pagesなどの静的サイトジェネレータで使用される設定ファイルです。
- **`docs/KEYBINDS.ja.md`**: アプリケーションのキーバインド（キー操作）に関する詳細な説明が日本語で記述されています。
- **`generated-docs/`**: コードベースから自動生成されたドキュメントを格納するためのディレクトリです。
- **`issue-notes/`**: 開発中の課題、検討事項、設計メモなどが個別のMarkdownファイルとして記録されています。
- **`src/app.rs`**: アプリケーションの主要なロジックを管理します。ユーザーからの入力イベント処理、アプリケーションの状態更新、UI描画のトリガーなどが含まれると考えられます。
- **`src/app_init.rs`**: アプリケーションが起動する際の初期設定や準備処理を担います。
- **`src/audio.rs`**: YM2151サーバーとの通信を担当し、音色パラメータの変更をリアルタイムで音声フィードバックサーバーに送信するロジックが含まれます。
- **`src/config.rs`**: アプリケーションの設定（例: キーバインドの設定）の読み込み、保存、管理を行います。
- **`src/file_ops.rs`**: 音色データのファイルへの保存や、ファイルからの読み込みといった永続化処理を担当します。
- **`src/main.rs`**: プロジェクトのエントリポイントです。アプリケーションの起動、初期化、メインループの実行を調整します。
- **`src/midi_conversion.rs`**: MIDIデータに関連する変換ロジックを扱います。音色データとMIDIノート番号の関連付けなど。
- **`src/models.rs`**: アプリケーション全体で使用されるデータ構造（例: YM2151の音色パラメータ、アプリケーションの状態など）を定義します。
- **`src/register.rs`**: YM2151音源のレジスタに関する定義や、それらの値の操作ロジックが含まれます。
- **`src/tests/`**: アプリケーションの各モジュールに対する単体テストが格納されているディレクトリです。
    - **`src/tests/app_tests.rs`**: `app.rs`モジュールの機能に関するテストコードです。
    - **`src/tests/file_ops_tests.rs`**: `file_ops.rs`モジュールのファイル操作機能に関するテストコードです。
    - **`src/tests/midi_conversion_tests.rs`**: `midi_conversion.rs`モジュールのMIDI変換機能に関するテストコードです。
    - **`src/tests/mod.rs`**: テストモジュール群をまとめるためのファイルです。
    - **`src/tests/register_tests.rs`**: `register.rs`モジュールのレジスタ操作に関するテストコードです。
    - **`src/tests/ui_tests.rs`**: `ui.rs`モジュールのユーザーインターフェース描画に関するテストコードです。
    - **`src/tests/verbose_logging_tests.rs`**: 詳細なロギング機能に関するテストコードです。
- **`src/ui.rs`**: ターミナルユーザーインターフェース (TUI) の描画ロジックをカプセル化しています。`ratatui`クレートを使用して画面要素を構築し、表示します。
- **`tones/general_midi/000_AcousticGrand.json`**: General MIDIの基準に準拠した「アコースティックグランドピアノ」の音色データがJSON形式で格納されています。
- **`tones/general_midi/tone_names.json`**: 音色の名前やカテゴリなど、音色管理のためのメタ情報がJSON形式で格納されています。
- **`ym2151-tone-editor.toml.example`**: アプリケーションの設定ファイルの一例です。ユーザーがカスタム設定を行う際のテンプレートとして利用されます。

## 関数詳細説明
このプロジェクトの情報からは、具体的な関数名、引数、戻り値、機能のシグネチャが直接提供されていません。そのため、詳細な関数説明は行えませんが、一般的なRust TUIアプリケーションにおいて、以下のような役割を持つ関数群が存在すると考えられます。

- **アプリケーションのエントリポイント**: `main()`関数がプログラムの実行を開始し、アプリケーションのメインループを起動します。
- **アプリケーションの実行管理**: `run()`や`start_app()`のような関数が、アプリケーションのライフサイクル（初期化、イベント処理、描画、終了）を管理します。
- **イベント処理**: キー入力やマウス操作といったユーザーイベントを検出し、それに応じてアプリケーションの状態を更新する`handle_event()`のような関数。
- **UI描画**: アプリケーションの現在の状態に基づいて、ターミナル画面にUI要素を描画する`draw_ui()`や`render()`のような関数。
- **状態更新**: 音色パラメータの変更、カーソルの移動など、アプリケーションの内部状態を管理・更新する`update_tone_parameter()`や`move_cursor()`のような関数。
- **ファイル操作**: 音色データをファイルに保存したり、ファイルから読み込んだりする`save_tone()`や`load_tone()`のような関数。
- **音声フィードバック**: 編集中の音色データをYM2151サーバーに送信し、リアルタイムで音を鳴らす`send_audio_command()`のような関数。

これらの関数は、それぞれのモジュール（`app.rs`, `ui.rs`, `audio.rs`など）内で定義され、相互に連携しながらアプリケーションの機能を実現しています。

## 関数呼び出し階層ツリー
```
関数呼び出し階層を分析できませんでした。

---
Generated at: 2025-12-01 07:08:27 JST
