Last updated: 2025-12-04

# Project Overview

## プロジェクト概要
- YM2151（OPM）FM音源の音色を編集するための、Windows向けターミナルユーザーインターフェース（TUI）アプリケーションです。
- Rust言語で開発されており、リアルタイムでの音声フィードバックを提供しながら、直感的な操作で音色パラメータを調整できます。
- 編集した音色は自動で保存され、次回起動時にロードされるため、効率的な音色作成をサポートします。

## 技術スタック
- フロントエンド:
    - **ratatui 0.28**: ターミナル上でリッチなユーザーインターフェースを構築するためのフレームワークです。
    - **crossterm 0.28**: クロスプラットフォームでターミナル操作（イベント処理、カーソル移動、色など）を行うためのライブラリです。
- 音楽・オーディオ:
    - **ym2151-log-play-server**: リアルタイムでYM2151音源の音声フィードバックを提供するサーバーライブラリです。エディタと連携し、パラメータ変更を即座に音で確認できます。
    - **mmlabc-to-smf-rust** (将来の展望): MML（Music Macro Language）をSMF（Standard MIDI File）に変換するためのライブラリです。音色プレビュー時にMMLをSMFに変換する用途で利用が検討されています。
    - **smf-to-ym2151log-rust** (将来の展望): SMFをYM2151のレジスタログデータに変換するためのライブラリです。音色プレビュー時に利用が検討されています。
- 開発ツール:
    - **Rust**: 高い安全性、パフォーマンス、並行性を提供するシステムプログラミング言語であり、本プロジェクトの主要な開発言語です。
- ビルドツール:
    - **Cargo**: Rustの公式パッケージマネージャー兼ビルドシステムです。プロジェクトの依存関係の管理、ビルド、テスト、ドキュメンテーション生成などを行います。
- 言語機能:
    - **Rust 1.70 以降**: プロジェクトをビルドおよび実行するためのRustコンパイラの最低バージョン要件です。

## ファイル階層ツリー
```
📄 .gitignore
📄 Cargo.lock
📄 Cargo.toml
📄 LICENSE
📖 README.ja.md
📖 README.md
📄 _config.yml
📁 docs/
  📖 KEYBINDS.ja.md
📁 generated-docs/
🌐 googled947dc864c270e07.html
📁 issue-notes/
  📖 100.md
  📖 101.md
  📖 102.md
  📖 103.md
  📖 104.md
  📖 105.md
  📖 106.md
  📖 107.md
  📖 108.md
  📖 109.md
  📖 110.md
  📖 111.md
  📖 112.md
  📖 113.md
  📖 114.md
  📖 115.md
  📖 116.md
  📖 130.md
  📖 95.md
  📖 96.md
  📖 97.md
  📖 99.md
📁 src/
  📄 app.rs
  📄 app_init.rs
  📄 audio.rs
  📄 config.rs
  📄 file_ops.rs
  📄 main.rs
  📄 midi_conversion.rs
  📄 models.rs
  📄 register.rs
  📁 tests/
    📄 app_tests.rs
    📄 file_ops_tests.rs
    📄 midi_conversion_tests.rs
    📄 mod.rs
    📄 register_tests.rs
    📄 ui_tests.rs
    📄 verbose_logging_tests.rs
  📄 ui.rs
📁 tones/
  📁 general_midi/
    📊 000_AcousticGrand.json
    📊 tone_names.json
📄 ym2151-tone-editor.toml.example
```

## ファイル詳細説明
- **`.gitignore`**: Gitがバージョン管理の対象外とするファイルやディレクトリを指定します。
- **`Cargo.lock`**: プロジェクトが依存するクレートの具体的なバージョンを記録し、ビルドの一貫性を保証します。
- **`Cargo.toml`**: Rustプロジェクトのメタデータ（プロジェクト名、バージョン、著者など）と、依存する外部クレートを定義します。
- **`LICENSE`**: プロジェクトのライセンス情報（著作権や利用条件）を記述します。
- **`README.ja.md` / `README.md`**: プロジェクトの概要、機能、セットアップ方法、使い方、開発状況などを記述した主要なドキュメントです。日本語版と英語版があります。
- **`_config.yml`**: GitHub Pagesなどの静的サイトジェネレーターの設定ファイルで、プロジェクトのドキュメントサイト構築に使用されます。
- **`docs/KEYBINDS.ja.md`**: アプリケーションのキーバインド（操作方法）に関する詳細な説明を記述した日本語ドキュメントです。
- **`generated-docs/`**: 自動生成されたドキュメントや資料を格納するディレクトリです。
- **`googled947dc864c270e07.html`**: Googleサイト認証用のファイルで、ウェブサイトの所有権確認に使用されます。
- **`src/app.rs`**: アプリケーションの主要なロジックを管理します。ユーザーインターフェースの状態、イベント処理、データフローの制御などが含まれます。
- **`src/app_init.rs`**: アプリケーションの起動時における初期化処理を定義します。設定の読み込みやリソースの準備などを行います。
- **`src/audio.rs`**: YM2151音源のリアルタイム音声フィードバックに関するロジックを扱います。`ym2151-log-play-server`との連携を管理します。
- **`src/config.rs`**: アプリケーションの各種設定（キーバインド、デフォルト値など）を定義し、読み込み・保存のロジックを提供します。
- **`src/file_ops.rs`**: ファイルシステム操作、特に音色データの自動セーブとロード、および音色ファイルの管理機能を提供します。
- **`src/main.rs`**: Rustアプリケーションのエントリポイント（プログラムの開始点）です。
- **`src/midi_conversion.rs`**: MIDI関連のデータ形式（SMFなど）とYM2151のレジスタデータとの相互変換ロジックを扱います。音色プレビューMML処理に関連します。
- **`src/models.rs`**: アプリケーション内で使用されるデータ構造（例: YM2151の音色パラメータ、アプリケーションの状態など）を定義します。
- **`src/register.rs`**: YM2151音源のレジスタ（設定値）に関する操作、バリデーション、変換などのロジックを扱います。
- **`src/tests/`**: アプリケーションの各モジュールに対する単体テストや統合テストのコードを格納するディレクトリです。
- **`src/ui.rs`**: ターミナルユーザーインターフェース（TUI）の描画ロジックを担当します。`ratatui`クレートを使用して画面レイアウトやウィジェットを構成します。
- **`tones/general_midi/000_AcousticGrand.json`**: General MIDIの「Acoustic Grand Piano」に相当するYM2151音色のデータがJSON形式で格納されています。
- **`tones/general_midi/tone_names.json`**: 音色名を管理するためのJSONファイルです。
- **`ym2151-tone-editor.toml.example`**: アプリケーションの設定ファイル（`config.rs`で読み込まれる）の記述例を提供します。

## 関数詳細説明
プロジェクト情報から具体的なRustの関数シグネチャを特定できなかったため、一般的な説明となります。
ただし、リアルタイム音声フィードバックの説明中で言及されている`ensure_server_ready()`関数は、`ym2151-log-play-server`ライブラリの一部であり、音声サーバーの準備が整っていることを確認し、必要に応じて起動する役割を持ちます。
その他の主なRustファイル（`app.rs`, `audio.rs`, `file_ops.rs`, `ui.rs`など）には、それぞれのファイルが担当する機能（例: UIの描画、オーディオ再生の制御、ファイル操作、アプリケーション状態の更新など）を実行するための関数群が含まれています。

## 関数呼び出し階層ツリー
```
関数呼び出し階層を分析できませんでした。

---
Generated at: 2025-12-04 07:09:16 JST
